LOAD EMPLOYEE

T1 <- SELECT Salary  >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn, Salary FROM T1

T2 <- CROSS EMPLOYEE EMPLOYEE
T3 <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM T2
T4 <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM T3
Q2 <- PROJECT EMPLOYEE1_Ssn, EMPLOYEE2_Ssn, EMPLOYEE1_Bdate FROM T4
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q2
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM Q2
RENAME EMPLOYEE1_Bdate TO Bdate FROM Q2

LOAD WORKS_ON
T5 <- CROSS WORKS_ON EMPLOYEE
T6 <- SELECT Essn == Ssn FROM T5
T7 <- PROJECT Ssn, Pno, Sex FROM T6
T8 <- CROSS T7 T7
T9 <- SELECT T71_Pno == T72_Pno FROM T8
T10 <- SELECT T71_Sex == 0 FROM T9
T11 <- SELECT T72_Sex == 1 FROM T10
Q3 <- PROJECT T71_Pno FROM T11
RENAME T71_Pno TO Pno FROM Q3 

T12 <- PROJECT Ssn, Pno, Super_ssn FROM T6
T13 <- CROSS T12 T12
T14 <- SELECT T121_Super_ssn == T122_Ssn FROM T13
T15 <- SELECT T121_Pno == T122_Pno FROM T14
Q4 <- PROJECT T121_Ssn, T121_Super_ssn , T122_Pno FROM T15
RENAME T121_Ssn TO Ssn FROM Q4
RENAME T121_Super_ssn TO Super_ssn FROM Q4
RENAME T122_Pno TO Pno FROM Q4

EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4

QUIT